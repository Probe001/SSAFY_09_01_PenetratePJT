<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="com.ssafy.group5.model.mapper.UserMapper">
	
	<!-- 유저 정보 반환 -->
	<select id="getUser" parameterType="User" resultType="User">
		select *
		from user
		where userid=#{userid} and userpwd=#{userpwd}
	</select>
	
	<!-- 회원가입 -->
	<insert id="signUp" parameterType="Map">
		insert into user (userid, userpwd, username, email, joindate)
		values (#{userid}, #{userpwd}, #{username}, #{email}, now())
	</insert>
	
	<select id="getUserById" parameterType="Map" resultType="User">
		select *
		from user
		where userid=#{userid} and email=#{email}
	</select>
	
	<!-- 회원 정보 수정 -->
	<update id="updateUserInfo" parameterType="Map">
		update user 
		set username=#{username}, email=#{email}
		where userid=#{userid} and userpwd=#{userpwd}
	</update>

	<!-- 회원 정보 삭제 (회원 탈퇴) -->
	<delete id="deleteUser" parameterType="User">
		delete from user
		where userid=#{userid} and userpwd=#{userpwd}
	</delete>
	
	<!-- 비밀번호 변경 -->
	<update id="changePassword" parameterType="Map">
		update user
		set userpwd=#{newpwd}
		where email=#{email} 
		<if test="curpwd != null">
			and userpwd=#{curpwd}
		</if>
	</update>
	
</mapper>